"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDiffDbn = void 0;
var IRApp_1 = require("../../IRNodes/IRApp.js");
var IRDelayed_1 = require("../../IRNodes/IRDelayed.js");
var IRForced_1 = require("../../IRNodes/IRForced.js");
var IRFunc_1 = require("../../IRNodes/IRFunc.js");
var IRHoisted_1 = require("../../IRNodes/IRHoisted.js");
var IRLetted_1 = require("../../IRNodes/IRLetted.js");
function getDiffDbn(parentNode, childNode) {
    var stack = [{ term: parentNode, dbn: 0 }];
    while (stack.length > 0) {
        var _a = stack.pop(), t = _a.term, dbn = _a.dbn;
        if (t === childNode)
            return dbn;
        if (t instanceof IRLetted_1.IRLetted) {
            stack.push({ term: t.value, dbn: dbn });
            continue;
        }
        if (t instanceof IRApp_1.IRApp) {
            stack.push({ term: t.fn, dbn: dbn }, { term: t.arg, dbn: dbn });
            continue;
        }
        if (t instanceof IRDelayed_1.IRDelayed) {
            stack.push({ term: t.delayed, dbn: dbn });
            continue;
        }
        if (t instanceof IRForced_1.IRForced) {
            stack.push({ term: t.forced, dbn: dbn });
            continue;
        }
        if (t instanceof IRFunc_1.IRFunc) {
            stack.push({ term: t.body, dbn: dbn + t.arity });
            continue;
        }
        if (t instanceof IRHoisted_1.IRHoisted) {
            stack.push({ term: t.hoisted, dbn: dbn });
            continue;
        }
    }
    return undefined;
}
exports.getDiffDbn = getDiffDbn;
