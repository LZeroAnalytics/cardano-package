"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ptraceError = exports.ptraceIfFalse = exports.ptraceIfTrue = exports.ptrace = void 0;
var IRNative_1 = require("../../../IR/IRNodes/IRNative/index.js");
var Term_1 = require("../../Term/index.js");
var type_system_1 = require("../../type_system/index.js");
var pdelay_1 = require("../pdelay.js");
var perror_1 = require("../perror.js");
var pfn_1 = require("../pfn.js");
var pforce_1 = require("../pforce/index.js");
var phoist_1 = require("../phoist.js");
var plam_1 = require("../plam.js");
var pBool_1 = require("../std/bool/pBool.js");
var addApplications_1 = require("./addApplications.js");
var bool_1 = require("./bool/index.js");
function ptrace(returnT) {
    return (0, addApplications_1.addApplications)(new Term_1.Term((0, type_system_1.fn)([type_system_1.str, returnT], returnT), function (_dbn) { return IRNative_1.IRNative.trace; }));
}
exports.ptrace = ptrace;
exports.ptraceIfTrue = (0, phoist_1.phoist)((0, pfn_1.pfn)([
    (0, type_system_1.delayed)(type_system_1.str),
    type_system_1.bool,
], type_system_1.bool)(function (msg, boolean) {
    return (0, bool_1.pif)(type_system_1.bool).$(boolean)
        .then(ptrace(type_system_1.bool).$((0, pforce_1.pforce)(msg)).$((0, pBool_1.pBool)(true)))
        .else((0, pBool_1.pBool)(false));
}));
exports.ptraceIfFalse = (0, phoist_1.phoist)((0, pfn_1.pfn)([
    (0, type_system_1.delayed)(type_system_1.str),
    type_system_1.bool,
], type_system_1.bool)(function (msg, boolean) {
    return (0, bool_1.pif)(type_system_1.bool).$(boolean)
        .then((0, pBool_1.pBool)(true))
        .else(ptrace(type_system_1.bool).$((0, pforce_1.pforce)(msg)).$((0, pBool_1.pBool)(false)));
}));
function ptraceError(t, somemsg) {
    return (0, phoist_1.phoist)((0, plam_1.plam)(type_system_1.str, t)(function (msg) { return (0, pforce_1.pforce)(ptrace((0, type_system_1.delayed)(t)).$(msg).$((0, pdelay_1.pdelay)((0, perror_1.perror)(t, somemsg)))); }));
}
exports.ptraceError = ptraceError;
